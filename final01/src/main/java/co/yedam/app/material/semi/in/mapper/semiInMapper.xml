<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="co.yedam.app.material.semi.in.mapper.SemiInMapper">
<!-- 전체조회 -->
	<select id="selectSemiInList" resultType="SemiInVO">
		SELECT a.semi_lot semi_lot, a.prod_code prod_code, b.prod_name prod_name, a.semi_in_amt semi_in_amt, c.emp_name emp_name, a.semi_ind semi_ind, a.semi_exd semi_exd 
		FROM semi_in a JOIN com_prod b
			ON(a.prod_code = b.prod_code)
				LEFT JOIN com_emp c
					ON(a.emp_code = c.emp_code)
		ORDER BY a.semi_ind DESC
	</select>
	
	<!-- 전체조회 검색 -->
	<select id="selectSemiInSearch" resultType="SemiInVO">
		SELECT a.semi_lot semi_lot, a.prod_code prod_code, b.prod_name prod_name, a.semi_in_amt semi_in_amt, c.emp_name emp_name, a.semi_ind semi_ind, a.semi_exd semi_exd 
		FROM semi_in a JOIN com_prod b
			ON(a.prod_code = b.prod_code)
				LEFT JOIN com_emp c
					ON(a.emp_code = c.emp_code)
		<where>
			<if test="productCode != null and productCode != ''">
				AND a.prod_code LIKE '%' || #{productCode} || '%'
			</if>
			<if test="startDate != null and startDate != ''">
				AND a.semi_ind <![CDATA[>=]]> TO_DATE(#{startDate}, 'YYYY-MM-DD')
			</if>
			<if test="endDate != null and endDate != ''">
				AND a.semi_ind <![CDATA[<=]]> TO_DATE(#{endDate}, 'YYYY-MM-DD')
			</if>
		</where>
		ORDER BY a.semi_ind DESC
	</select>
	
	<!-- 반제품 목록 모달 -->
	<select id="getSemiModal" resultType="SemiInVO">
		SELECT prod_code, prod_name
		FROM com_prod
		WHERE prod_kind = 'S' 
	</select>
	

</mapper>